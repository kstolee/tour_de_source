\section{Study}
\subsection{\centerline{RECORDING REGEX USAGES}}
Using GHTorrent, we found the clone urls of \DTLfetch{data}{key}{nCloneURL}{value} github projects that had Python listed as the main language.  After consulting with github about the polite way to mine their service, we used 3 separate machines to clone projects in parallel.  On each machine, one attempt was made to clone each project into a unique directory.  \DTLfetch{data}{key}{nAborted}{value} of these attempts failed, so a total of \DTLfetch{data}{key}{nProjScanned}{value} projects were scanned overall.  For each of these projects, the java program launched a Python process that used `Astroid' to build the AST of each python file in the unique directory, recording uses of the `re' module.  Here is an example Python code using the `re' module:

Placeholder for several examples of useage of the `re' module...image?  Shows example of function, flags pattern.

TODO...mention rewinding, duplicate skipping, exact criteria for citing a usage...For each of the \DTLfetch{data}{key}{nUsages}{value} regex usages observed, we recorded which `re' function was used, what flags (if any) were used, and what pattern was found.

\subsection{\centerline{FILTERING REGEX USAGES}}
Because we want to let regex patterns alone define behavior later in our analysis, all regex usages where behavioral flags are used are discarded, along with all invalid pattern strings.   TODO - change to percents \DTLfetch{data}{key}{nBadFlags}{value} usages were discarded because they used behavior-altering flags, and \DTLfetch{data}{key}{nInvalidPattern}{value} without flags were discarded because their pattern strings were invalid (could not be compiled by Python into a regex object).

\DTLfetch{data}{key}{nCleanUsages}{value} regex usages remain (meow percent), which are then condensed to \DTLfetch{data}{key}{nDistinctPatterns}{value} distinct pattern strings.  The number of distinct pattern strings is much smaller because the same pattern string is often used in many distinct files and projects by different functions with different flags and these all count as separate usages.  The resulting set of patten strings were parsed using TODO - \footnote{\url{www.source}} PCRE parser.  \DTLfetch{data}{key}{percentPCREError}{value}\% of the strings caused the PCRE parser to raise an error.  Another \DTLfetch{data}{key}{percentAlien}{value}\% used regex features that we have chosen to exclude in this study (most notably named capturing groups).  The \DTLfetch{data}{key}{nCorpus}{value} distinct pattern strings that remain are given a weight based upon how many projects the pattern appeared in (FYI no forked projects were scanned).

TODO - clean this: So then we use the following 4? techniques to try and best represent the entire corpus using a few regexes: 1. weight (frequency of usage across projects) 2. features (matching properties of feature usage) 3. syntactic clustering 4. semantic clustering ...and also we give the topN clones by weight, and a list that tries to include information from all 4 lists?  That will be all.  Future work: mine more projects and compare that result with this result.  Compare across languages (java, javascript,ruby,etc.).

TODO - list research questions (metrics and how they are computed?)

RQ1: How is the {\tt re module} used in python projects?
RQ2: How frequently are regexes used in python projects?
RQ3: Which regex language features are used most commonly in python?
RQ4: How syntactically diverse are regexes used in python?
RQ5: How semangically diverse are regexes used in python?

\subsubsection{\centerline{FEATURES}}

Here is a table showing all the features included in this study...

\topcaption{This is top caption}
\bottomcaption{This is bottom caption}
\tablecaption{which features are studied, and how this study names them}
\tablefirsthead{code & description & example usage\\ \toprule }
%
\tablehead{%
\multicolumn{2}{c}%
{{\bfseries  Continued from previous column}} \\
 \midrule code & description & example usage\\ \toprule}
%
\tabletail{%
\midrule \multicolumn{2}{r}{{Continued on next column}} \\ \midrule}
\tablelasttail{%
\bottomrule}
\begin{xtabular}{lll}
DEC &  any of: 0123456789 &
\begin{minipage}{0.5in}\begin{verbatim}
\d
\end{verbatim}\end{minipage} \\
\midrule
NDEC & any non-decimal &
\begin{minipage}{0.5in}\begin{verbatim}
\D
\end{verbatim}\end{minipage} \\
\midrule
WSP &
\begin{minipage}{0.5in}\begin{verbatim}
\t\n\r\v\f or space
\end{verbatim}\end{minipage} &
\begin{minipage}{0.5in}\begin{verbatim}
\s
\end{verbatim}\end{minipage} \\
\midrule
NWSP & non-whitespace &
\begin{minipage}{0.5in}\begin{verbatim}
\S
\end{verbatim}\end{minipage} \\
\midrule
WRD & letters, underscore, digits &
\begin{minipage}{0.5in}\begin{verbatim}
\w
\end{verbatim}\end{minipage} \\
\midrule
NWRD & non-word chars &
\begin{minipage}{0.5in}\begin{verbatim}
\W
\end{verbatim}\end{minipage} \\
\midrule
RNG & use of range shorthand &
\begin{minipage}{0.5in}\begin{verbatim}
[a-z]
\end{verbatim}\end{minipage} \\
\midrule
LKA & matching sequence follows &
\begin{minipage}{0.5in}\begin{verbatim}
a(?=bc)
\end{verbatim}\end{minipage} \\
\midrule
NLKA & sequence doesn't follow &
\begin{minipage}{0.5in}\begin{verbatim}
a(?!yz)
\end{verbatim}\end{minipage} \\
\midrule
LKB & matching sequence precedes &
\begin{minipage}{0.5in}\begin{verbatim}
(?<=a)bc
\end{verbatim}\end{minipage} \\
\midrule
NLKB & sequence doesn't precede &
\begin{minipage}{0.5in}\begin{verbatim}
(?<!x)yz
\end{verbatim}\end{minipage} \\
\midrule
NCG & group without capturing &
\begin{minipage}{0.5in}\begin{verbatim}
a(?:b)c
\end{verbatim}\end{minipage} \\
\midrule
CCC & custom char class &
\begin{minipage}{0.5in}\begin{verbatim}
[aeiou]
\end{verbatim}\end{minipage} \\
\midrule
CG & capturing group &
\begin{minipage}{0.5in}\begin{verbatim}
(caught)
\end{verbatim}\end{minipage} \\
\midrule
ANY & match any char &
\begin{minipage}{0.5in}\begin{verbatim}
.
\end{verbatim}\end{minipage} \\
\midrule
LIT & a literal char &
\begin{minipage}{0.5in}\begin{verbatim}
a
\end{verbatim}\end{minipage} \\
\midrule
NCCC & negated custom char class &
\begin{minipage}{0.5in}\begin{verbatim}
[^qxf]
\end{verbatim}\end{minipage} \\
\midrule
BKR & match the $i^{th}$ capture  &
\begin{minipage}{0.5in}\begin{verbatim}
(.)\1
\end{verbatim}\end{minipage} \\
\midrule
OR & logical or &
\begin{minipage}{0.5in}\begin{verbatim}
a|b
\end{verbatim}\end{minipage} \\
\midrule
END & match end-of-string &
\begin{minipage}{0.5in}\begin{verbatim}
$
\end{verbatim}\end{minipage} \\
\midrule
STR & match start-of-string &
\begin{minipage}{0.5in}\begin{verbatim}
^
\end{verbatim}\end{minipage} \\
\midrule
WNW & word/non-word boundary &
\begin{minipage}{0.5in}\begin{verbatim}
\b
\end{verbatim}\end{minipage} \\
\midrule
NWNW & negated WNW &
\begin{minipage}{0.5in}\begin{verbatim}
\B
\end{verbatim}\end{minipage} \\
\midrule
ADD & one-or-more repetition &
\begin{minipage}{0.5in}\begin{verbatim}
z+
\end{verbatim}\end{minipage} \\
\midrule
DBB & $n\le x \le m$ repetition &
\begin{minipage}{0.5in}\begin{verbatim}
z{3,8}
\end{verbatim}\end{minipage} \\
\midrule
KLE & zero-or-more repetition &
\begin{minipage}{0.5in}\begin{verbatim}
.*
\end{verbatim}\end{minipage} \\
\midrule
LWB & at least n repetitions &
\begin{minipage}{0.5in}\begin{verbatim}
z{15,}
\end{verbatim}\end{minipage} \\
\midrule
QST & zero-or-one repetitions &
\begin{minipage}{0.5in}\begin{verbatim}
z?
\end{verbatim}\end{minipage} \\
\midrule
SNG & exactly n repetitions &
\begin{minipage}{0.5in}\begin{verbatim}
z{8}
\end{verbatim}\end{minipage} \\
\midrule
ADDL & lazy ADD &
\begin{minipage}{0.5in}\begin{verbatim}
z+?
\end{verbatim}\end{minipage} \\
\midrule
DBBL & lazy DBB &
\begin{minipage}{0.5in}\begin{verbatim}
z{5,9}?
\end{verbatim}\end{minipage} \\
\midrule
KLEL & lazy KLE &
\begin{minipage}{0.5in}\begin{verbatim}
.*?
\end{verbatim}\end{minipage} \\
\midrule
LWBL & lazy LWB &
\begin{minipage}{0.5in}\begin{verbatim}
z{2,}?
\end{verbatim}\end{minipage} \\
\midrule
QSTL & lazy QST &
\begin{minipage}{0.5in}\begin{verbatim}
z??
\end{verbatim}\end{minipage} \\
\midrule
SNGL & lazy SNG &
\begin{minipage}{0.5in}\begin{verbatim}
z{6}?
\end{verbatim}\end{minipage} \\
\end{xtabular}





